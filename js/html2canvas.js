function GrabzIt(a){return new function(a){this.key=a,this.data=null,this.dataKey=null,this.options=null,this.post=!1,this.elem=null,this.ConvertURL=function(a,b){return this.data=a,this.dataKey="url",this.options=b,this.post=!1,this},this.ConvertHTML=function(a,b){return this.data=a,this.dataKey="html",this.options=b,this.post=!0,this},this._post=function(a){var b;b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var c=this;b.onreadystatechange=function(){4==this.readyState&&200==this.status&&c.elem.appendChild(c._handlePost(JSON.parse(this.responseText)))},b.open("POST",this._getBaseWebServiceUrl(),!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(a)},this._getBaseWebServiceUrl=function(){var a="//";return"https"!=window.location.protocol&&"http"!=window.location.protocol&&(a="http://"),a+"api.grabz.it/services/javascript.ashx"},this._createQueryString=function(a,b){var c="key="+encodeURIComponent(this.key)+"&"+a+"="+encodeURIComponent(b);if(null==this.options)return c;for(var d in this.options){if("format"!=d&&"cache"!=d&&"customWaterMarkId"!=d&&"quality"!=d&&"country"!=d&&"filename"!=d&&"errorid"!=d&&"errorclass"!=d&&"onfinish"!=d&&"onerror"!=d&&"delay"!=d&&"bwidth"!=d&&"bheight"!=d&&"height"!=d&&"width"!=d&&"target"!=d&&"requestas"!=d&&"download"!=d&&"suppresserrors"!=d&&"displayid"!=d&&"displayclass"!=d&&"background"!=d&&"pagesize"!=d&&"orientation"!=d&&"includelinks"!=d&&"includeoutline"!=d&&"title"!=d&&"coverurl"!=d&&"mtop"!=d&&"mleft"!=d&&"mbottom"!=d&&"mright"!=d&&"tabletoinclude"!=d&&"includeheadernames"!=d&&"includealltables"!=d&&"start"!=d&&"duration"!=d&&"speed"!=d&&"fps"!=d&&"repeat"!=d&&"reverse"!=d&&"templateid"!=d)throw"Option "+d+" not recognized!";var e=this.options[d];null!=e&&(c+="&"+d+"="+encodeURIComponent(e))}return c},this._createScriptNode=function(a){var b=document.createElement("script");return b.src=a,b},this._handlePost=function(a){if(null!=a){if(null==a.ID||""==a.ID)throw a.Message;return this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString("id",a.ID))}},this.Create=function(){var a=document.documentElement;null!=document.body&&(a=document.body),this.AddTo(a)},this.AddTo=function(a){if("string"==typeof a||a instanceof String){if(this.elem=document.getElementById(a),null==this.elem)throw"An element with the id "+a+" was not found"}else 1===a.nodeType&&(this.elem=a);if(null==this.elem)throw"No valid element was provided to attach the screenshot to";return this.post?void this._post(this._createQueryString(this.dataKey,this.data)):void this.elem.appendChild(this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString(this.dataKey,this.data)))}}(a)}